// Generated by CoffeeScript 1.6.3
(function() {
  $(document).ready(function() {
    window.existingSectionsList = null;
    window.views.ExistingSectionsList = Backbone.View.extend({
      el: '.existing-sections-layouts',
      initialize: function() {
        this.controller = this.options.controller;
        this.wrapper = $(".control-section").eq(this.controller.index);
        this.$el = this.wrapper.find(this.el);
        return this.render();
      },
      render: function() {
        var $el;
        $el = this.$el;
        console.log(this.collection.models);
        return _.each(this.collection.models, function(section) {
          section.set("inFlow", false);
          return $el.append(new views.SingleSectionWireFrame({
            model: section
          }).render().el);
        });
      }
    });
    window.views.SingleSectionWireFrame = Backbone.View.extend({
      tagName: 'li',
      template: $("#single-section").html(),
      initialize: function() {
        var self;
        self = this;
        return this.$el.draggable({
          cancel: '.view-section',
          revert: "invalid",
          cursor: "move",
          start: function(e, ui) {
            var builder;
            builder = allSections.at(sectionIndex).get("builder");
            $(ui.helper).addClass("dragging");
            if (builder != null) {
              builder.currentModel = self.model;
              builder.fromSideBar = false;
              return console.log;
            }
          },
          stop: function(e, ui) {
            $(ui.helper).removeClass("dragging");
            if (ui.helper.data('dropped') === true) {
              return $(e.target).remove();
            }
          }
        });
      },
      render: function() {
        var $el;
        $el = this.$el;
        $el.html(_.template(this.template, this.model.toJSON()));
        _.each(this.model.get("child_els").models, function(child, i) {
          if (i < 4) {
            return $el.append(new views.SectionThumbnail({
              model: child
            }).render().el);
          }
        });
        return this;
      },
      events: {
        "click .view-section": function() {
          var coll;
          coll = new collections.Elements();
          _.each(this.model.get("currentSection"), function(obj) {
            var model;
            model = new models.Element(obj);
            model.set("child_els", model.modelify(model.get("child_els")));
            return coll.add(model);
          });
          this.model.set("currentSection", coll);
          this.model.set("properties", new collections.Properties(this.model.get("properties")));
          console.log(this.model.get("currentSection"));
          return allSections.add(this.model);
        }
      }
    });
    return window.views.SectionThumbnail = Backbone.View.extend({
      tagName: 'div',
      render: function() {
        var $el, styles;
        $el = this.$el.addClass("thumb-object");
        styles = this.model.get("styles");
        if (styles != null) {
          this.$el.css(styles);
        }
        _.each(this.model.get("child_els").models, function(child, i) {
          console.log(child);
          if (i < 4) {
            return $el.append(new views.SectionThumbnail({
              model: child
            }).render().el);
          }
        });
        return this;
      }
    });
  });

}).call(this);
