// Generated by CoffeeScript 1.6.3
(function() {
  $(document).ready(function() {
    var getSlope;
    window.models = {};
    window.views = {};
    window.collections = {};
    window.propertyLink = $("#property-link").html();
    if (localStorage.settings == null) {
      localStorage.settings = {};
    }
    window.settings = {
      history_length: localStorage.settings.history_length || 15
    };
    window.globals = {
      setPlaceholders: function(draggable, collection) {
        var after, before;
        draggable.before(before = new views.droppablePlaceholder({
          collection: collection
        }).render()).after(after = new views.droppablePlaceholder({
          collection: collection
        }).render());
        if (before.prev().css("display") === "inline-block") {
          return before.css("height", before.prev().height() + "px");
        }
      }
    };
    String.prototype.parseBool = function() {
      if (this.toLowerCase() === "false") {
        return false;
      } else if (this.toLowerCase() === "true") {
        return true;
      }
      return null;
    };
    getSlope = function(y1, y, x1, x) {
      return (y - y1) / (x - x1);
    };
    window.launchModal = function(content) {
      var modal;
      modal = $("<div />").addClass("modal");
      if ($.isArray(content)) {
        _.each(content, function(item) {
          return modal.append(item);
        });
      } else {
        modal.html(content);
      }
      modal.prepend("<i class='close-modal icon-multiply'></i>");
      $(document.body).addClass("active-modal").append(modal);
      return modal;
    };
    window.launchDraggableModal = function(content, tagname, appendTo, title) {
      var modal;
      title = $("<h2/>").html("<i class='icon icon-move'></i>" + title).addClass("drag-handle");
      modal = $("<" + (tagname || "div") + "/>").html($(content).addClass("hidden")).addClass("draggable-modal");
      title.prependTo(modal);
      modal.draggable({
        revert: 'invalid',
        start: function(e, ui) {
          return ui.helper.addClass("moved");
        },
        stop: function(e, ui) {
          var snapped, snappedTo;
          snapped = $(this).data('uiDraggable').snapElements;
          return snappedTo = $.map(snapped, function(element) {
            if (element.snapping) {
              return element.item;
            } else {
              return null;
            }
          });
        },
        snap: '.section-builder-wrap:not(:hidden), .sidebar-controls:not(:hidden), .organize-elements:not(:hidden), .draggable-modal:not(:hidden)',
        cancel: '.close-arrow',
        containment: '.container',
        handle: '.drag-handle'
      });
      modal.prependTo(appendTo || document.body);
      modal.append($("<div/>").addClass("close-arrow icon-uniF48A icon pointer"));
      return modal;
    };
    $.fn.launchModal = function(content) {
      return this.addClass("modal").prependTo($("body").addClass("active-modal"));
    };
    window.validNumber = function(num) {
      return !isNaN(parseInt(num));
    };
    window.cc = function(msg, color) {
      return console.log("%c" + msg, "color:" + color + ";font-weight:bold;");
    };
    $(this).delegate(".close-modal", "click", function() {
      $(this).closest(".modal").remove();
      return $("body").removeClass("active-modal");
    });
    $(this).delegate(".modal .confirm", "click", function() {
      $(document.body).removeClass("active-modal");
      return $(this).closest(".modal").remove();
    });
    $(this).delegate("[data-switch-text]", "click", function() {
      var $t, currtext, switchtext;
      $t = $(this);
      switchtext = $t.data("switch-text");
      currtext = $t.text();
      $t.text(switchtext);
      return $t.data("switch-text", currtext);
    });
    $(this).delegate(".close-arrow", "click", function() {
      return $(this).toggleClass("flipped").siblings(":not(.drag-handle)").toggle();
    });
    $(this).delegate("[data-modal] input", "click", function(e) {
      var $t, modal;
      $t = $(this);
      modal = $t.parent().data("modal");
      $(".control-section").eq(currIndex).find(".draggable-modal." + modal).toggle("slide", {
        direction: "left"
      }, 200);
      return e.stopPropagation();
    });
    $(this).delegate("[data-modal]", "click", function(e) {
      var $t, modal;
      $t = $(this);
      modal = $t.data("modal");
      $(".control-section").eq(currIndex).find(".draggable-modal." + modal).toggle("slide", {
        direction: "left"
      }, 200);
      return $t.find("input").prop("checked", !$t.find("input").prop("checked"));
    });
    return $(this).delegate(".draggable-modal h2", "click", function() {});
  });

}).call(this);
